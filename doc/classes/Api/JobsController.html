<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Api::JobsController [Codem Scheduler documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <div class='name'>
          <span class='type'>Class</span>
          Api::JobsController
        </div>
        <ol class='paths'>
          <li>
            <a href="../../files/app/controllers/api/jobs_controller_rb.html">app/controllers/api/jobs_controller.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="ApiController.html">Api::ApiController</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <h1>Jobs controller</h1>
            <h2>States</h2>
            <p>
            A job can be in one of the following states:
            </p>
            <table>
            <tr><td valign="top">scheduled:</td><td>Scheduled to be sent to the Transcoder instances
            
            </td></tr>
            <tr><td valign="top">accepted:</td><td>Accepted by a Transcoder instance, waiting to start processing
            
            </td></tr>
            <tr><td valign="top">processing:</td><td>Being processed by a Transcoder Instance
            
            </td></tr>
            <tr><td valign="top">on_hold:</td><td>Waiting for a Transcoder to become responsive again
            
            </td></tr>
            <tr><td valign="top">success:</td><td>Successfully completed
            
            </td></tr>
            <tr><td valign="top">failed:</td><td>An error occured
            
            </td></tr>
            </table>
            <h2>Pagination</h2>
            <p>
            For methods that use pagination, a <tt>page</tt> parameters can be sent to
            display that particular page of jobs. Jobs are paginated with 20 jobs per
            page. For example, to get the 5th page of successfully completed jobs, use:
            </p>
            <pre>http://host.com/api/jobs.json?page=5</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000006">accepted</a></li>
              <li><a href="#M000010">completed</a></li>
              <li><a href="#M000012">create</a></li>
              <li><a href="#M000011">failed</a></li>
              <li><a href="#M000004">index</a></li>
              <li><a href="#M000008">on_hold</a></li>
              <li><a href="#M000007">processing</a></li>
              <li><a href="#M000005">scheduled</a></li>
              <li><a href="#M000013">show</a></li>
              <li><a href="#M000009">success</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000006'>
                <a name='M000006'></a>
                <div class='synopsis'>
                  <span class='name'>accepted</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of accepted jobs</h2>
                  <p>
                  Accepted jobs are accepted by a Transcoder, but have not yet begun
                  transcoding. This method uses pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000006-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000006-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 29</span>&#x000A;29:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">accepted</span>;     <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">accepted</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000010'>
                <a name='M000010'></a>
                <div class='synopsis'>
                  <span class='name'>completed</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="JobsController.html#M000009">success</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000012'>
                <a name='M000012'></a>
                <div class='synopsis'>
                  <span class='name'>create</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Creates a job</h2>
                  <p>
                  Creates a job using the specified parameters, which are all required. If
                  the request was valid, the created job is returned. If the request could
                  not be completed, a list of errors will be returned.
                  </p>
                  <h3>Parameters</h3>
                  <table>
                  <tr><td valign="top">input:</td><td>Input file to process
                  
                  </td></tr>
                  <tr><td valign="top">output:</td><td>Output file to write to
                  
                  </td></tr>
                  <tr><td valign="top">preset:</td><td>Preset name to use
                  
                  </td></tr>
                  </table>
                  <h3>Response codes</h3>
                  <table>
                  <tr><td valign="top">success:</td><td><tt>201 created</tt>
                  
                  </td></tr>
                  <tr><td valign="top">failed:</td><td><tt>406 Unprocessable Entity</tt>
                  
                  </td></tr>
                  </table>
                  <h3>Example</h3>
                  <pre>$ curl -d 'input=/tmp/foo.flv&amp;output=/tmp/bar.mp4&amp;preset=h264' http://localhost:3000/api/jobs&#x000A;&#x000A;{&#x000A;  &quot;job&quot;: {&#x000A;    &quot;callback_url&quot;:&quot;http://localhost:3000/api/jobs/26&quot;,&#x000A;    &quot;completed_at&quot;:null,&#x000A;    &quot;created_at&quot;:&quot;2011-05-10T08:25:00Z&quot;,&#x000A;    &quot;destination_file&quot;:&quot;/tmp/bar.mp4&quot;,&#x000A;    &quot;duration&quot;:null,&#x000A;    &quot;filesize&quot;:null,&#x000A;    &quot;host_id&quot;:1,&#x000A;    &quot;id&quot;:26,&#x000A;    &quot;message&quot;:null,&#x000A;    &quot;preset_id&quot;:1,&#x000A;    &quot;progress&quot;:null,&#x000A;    &quot;remote_job_id&quot;:&quot;fa832776a64b6844fb9f1a244757734a9d83c00f&quot;,&#x000A;    &quot;source_file&quot;:&quot;/tmp/foo.flv&quot;,&#x000A;    &quot;state&quot;:&quot;accepted&quot;,&#x000A;    &quot;transcoding_started_at&quot;:&quot;2011-05-10T08:25:03Z&quot;,&#x000A;    &quot;updated_at&quot;:&quot;2011-05-10T08:25:03Z&quot;&#x000A;  }&#x000A;}</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000012-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000012-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 85</span>&#x000A;85:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>&#x000A;86:     <span class="ruby-identifier">job</span> = <span class="ruby-constant">Job</span>.<span class="ruby-identifier">from_api</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">:callback_url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">job</span><span class="ruby-operator">|</span> <span class="ruby-identifier">api_job_url</span>(<span class="ruby-identifier">job</span>) })&#x000A;87:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">job</span>.<span class="ruby-identifier">valid?</span>&#x000A;88:       <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-value str">&quot;X-State-Changes-Location&quot;</span>] = <span class="ruby-identifier">api_state_changes_url</span>(<span class="ruby-identifier">job</span>)&#x000A;89:       <span class="ruby-identifier">respond_with</span> <span class="ruby-identifier">job</span>, <span class="ruby-identifier">:location</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">api_job_url</span>(<span class="ruby-identifier">job</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>&#x000A;90:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">jobs_path</span> }&#x000A;91:       <span class="ruby-keyword kw">end</span>&#x000A;92:     <span class="ruby-keyword kw">else</span>&#x000A;93:       <span class="ruby-identifier">respond_with</span> <span class="ruby-identifier">job</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>&#x000A;94:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-ivar">@job</span> = <span class="ruby-identifier">job</span>; <span class="ruby-identifier">render</span> <span class="ruby-value str">&quot;/jobs/new&quot;</span>}&#x000A;95:       <span class="ruby-keyword kw">end</span>&#x000A;96:     <span class="ruby-keyword kw">end</span>&#x000A;97:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000011'>
                <a name='M000011'></a>
                <div class='synopsis'>
                  <span class='name'>failed</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of failed jobs</h2>
                  <p>
                  Jobs become failed if the Transcoder reports an error. This method uses
                  pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000011-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000011-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 46</span>&#x000A;46:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">failed</span>;       <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">failed</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000004'>
                <a name='M000004'></a>
                <div class='synopsis'>
                  <span class='name'>index</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of recent jobs</h2>
                  <p>
                  This method uses pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000004-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000004-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 21</span>&#x000A;21:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>;        <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">scoped</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000008'>
                <a name='M000008'></a>
                <div class='synopsis'>
                  <span class='name'>on_hold</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of jobs that are on hold</h2>
                  <p>
                  Jobs will be put on hold when a Transcoder instance is unavailable. This
                  method uses pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000008-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000008-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 37</span>&#x000A;37:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">on_hold</span>;      <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">on_hold</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000007'>
                <a name='M000007'></a>
                <div class='synopsis'>
                  <span class='name'>processing</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of jobs being processed.</h2>
                  <p>
                  Jobs being processed are being transcoded by a Transcoder. This method uses
                  pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000007-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000007-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 33</span>&#x000A;33:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">processing</span>;   <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">processing</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000005'>
                <a name='M000005'></a>
                <div class='synopsis'>
                  <span class='name'>scheduled</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of scheduled jobs</h2>
                  <p>
                  Scheduled jobs are created, but not yet accepted by the transcoders. This
                  method uses pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000005-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000005-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 25</span>&#x000A;25:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scheduled</span>;    <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">scheduled</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000013'>
                <a name='M000013'></a>
                <div class='synopsis'>
                  <span class='name'>show</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Shows a job</h2>
                  <p>
                  The displayed job will have its status updated to provide an up-to-date
                  view of attributes.
                  </p>
                  <h3>Parameters</h3>
                  <table>
                  <tr><td valign="top">id:</td><td>The id of the job to show
                  
                  </td></tr>
                  </table>
                  <h3>Example</h3>
                  <pre>{&#x000A;  &quot;job&quot;: {&#x000A;    &quot;callback_url&quot;:&quot;http://localhost:3000/api/jobs/26&quot;,&#x000A;    &quot;completed_at&quot;:null,&#x000A;    &quot;created_at&quot;:&quot;2011-05-10T08:25:00Z&quot;,&#x000A;    &quot;destination_file&quot;:&quot;/tmp/bar.mp4&quot;,&#x000A;    &quot;duration&quot;:null,&#x000A;    &quot;filesize&quot;:null,&#x000A;    &quot;host_id&quot;:1,&#x000A;    &quot;id&quot;:26,&#x000A;    &quot;message&quot;:null,&#x000A;    &quot;preset_id&quot;:1,&#x000A;    &quot;progress&quot;:null,&#x000A;    &quot;remote_job_id&quot;:&quot;fa832776a64b6844fb9f1a244757734a9d83c00f&quot;,&#x000A;    &quot;source_file&quot;:&quot;/tmp/foo.flv&quot;,&#x000A;    &quot;state&quot;:&quot;accepted&quot;,&#x000A;    &quot;transcoding_started_at&quot;:&quot;2011-05-10T08:25:03Z&quot;,&#x000A;    &quot;updated_at&quot;:&quot;2011-05-10T08:25:03Z&quot;&#x000A;  }&#x000A;}</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000013-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000013-source'>     <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 136</span>&#x000A;136:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>&#x000A;137:     <span class="ruby-identifier">job</span> = <span class="ruby-constant">Job</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])&#x000A;138:     <span class="ruby-identifier">job</span>.<span class="ruby-identifier">update_status</span>&#x000A;139:     <span class="ruby-identifier">respond_with</span> <span class="ruby-identifier">job</span>&#x000A;140:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000009'>
                <a name='M000009'></a>
                <div class='synopsis'>
                  <span class='name'>success</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <h2>Returns a list of successfully completed jobs</h2>
                  <p>
                  These jobs have been successfully transcoded. This method uses pagination.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000009-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000009-source'>    <span class="ruby-comment cmt"># File app/controllers/api/jobs_controller.rb, line 41</span>&#x000A;41:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">success</span>;      <span class="ruby-identifier">jobs_index</span>(<span class="ruby-constant">Job</span>.<span class="ruby-identifier">success</span>); <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
